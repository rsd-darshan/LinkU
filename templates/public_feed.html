<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University Recommendation Feed</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #f4f6f8;
            margin: 0;
            padding: 0;
        }
        .gif-picker {
    position: absolute;
    background-color: #ffffff;
    border: 1px solid #ccc;
    border-radius: 10px;
    padding: 10px;
    max-width: 300px;
    max-height: 300px;
    overflow-y: auto;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}


.fas.fa-heart {
    font-size: 20px;
    transition: color 0.3s ease; /* Smooth color transition */
}

.gif-thumbnail {
    display: inline-block;
    margin: 5px;
    cursor: pointer;
    width: 100px;
    height: auto;
}

.gif-thumbnail:hover {
    border: 2px solid #457b9d;
    border-radius: 5px;
}

        /* Header */
        nav, .header {
            background: #1876f2;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 5%;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            transition: transform 0.3s ease, opacity 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .hidden {
            transform: translateY(-100%);
            opacity: 0;
        }
/* Comment Section Styles */
.comment-section img {
    max-width: 100%; /* Ensure image doesn't exceed the width of its container */
    height: auto;    /* Maintain aspect ratio */
    max-height: 150px; /* Limit the image height for uniformity */
    border-radius: 10px; /* Add rounded corners for aesthetics */
    margin-top: 10px; /* Add spacing above the image */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Add a subtle shadow */
    object-fit: cover; /* Ensure image fits nicely in the container */
}
.emoji-picker {
    position: absolute;
    background-color: #ffffff;
    border: 1px solid #ccc;
    border-radius: 10px;
    padding: 10px;
    max-width: 300px;
    max-height: 200px;
    overflow-y: auto;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}

.emoji {
    display: inline-block;
    padding: 5px;
    font-size: 20px;
    cursor: pointer;
}

.emoji:hover {
    background-color: #f0f0f0;
    border-radius: 5px;
}

        .logo {
            color: #efefef;
            text-decoration: none;
            font-size: 1.5rem;
            font-weight: bold;
            margin-left: 20px; /* Move the logo more to the right */
        }

        .nav-right, .nav-left, .nav-links {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-box {
            background: #ffffff;
            width: 80%;
            border-radius: 20px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            transition: width 0.3s ease, box-shadow 0.3s ease;
        }

        .search-box input {
            width: 100%;
            background: transparent;
            padding: 10px;
            outline: none;
            border: 0;
            border-radius: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.2s ease;
        }

        .search-box input:focus {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .search-box:hover {
            width: 90%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .nav-user-icon img, .nav-user-login img, .post-header img, .profile-info img, .user-profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .nav-user-icon img:hover, .post-header img:hover, .profile-info img:hover {
            transform: scale(1.1);
        }

        /* Main Content */
        .content {
            margin-top: 60px;
            padding: 20px;
        }

        .content p {
            font-size: 1rem;
            line-height: 1.6;
            color: #333;
        }

        /* Layout */
        .container {
            display: flex;
            justify-content: center;
            margin-top: 80px; /* Adjust for header */
        }

        /* Sidebar (Profile & Friends) */
        .sidebar, .sidebar-right {
            width: 20%;
            margin-right: 20px;
            background-color: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .sidebar .profile-info {
            text-align: center;
        }

        .sidebar h3 {
            margin-top: 0;
        }

        .reaction-count {
            cursor: pointer;
        }

        .sidebar a {
            text-decoration: none;
            color: #333;
            display: block;
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.2s ease, padding-left 0.2s ease;
        }

        .sidebar a:hover {
            background-color: #f0f0f0;
            padding-left: 20px;
        }

        /* Main content (Feed) */
        .main-content {
            width: 60%;
        }

        /* Create Post Section */
        .create-post, .post-card {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.2s ease;
        }

        .create-post:hover, .post-card:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .create-post textarea, .post-input-container textarea {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            transition: border-color 0.2s ease;
        }

        .create-post textarea:focus, .post-input-container textarea:focus {
            border-color: #457b9d;
            outline: none;
        }

        .create-post button, .add-post-links button {
            background-color: #457b9d;
            color: white;
            padding: 12px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }

        .create-post button:hover, .add-post-links button:hover {
            background-color: #1d3557;
            transform: scale(1.05);
        }

        .video-container {
            position: relative;
        }

        .video-thumbnail {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            object-fit: cover;
        }

        .close-btn {
            background-color: transparent;
            border: none;
            font-size: 16px;
            color: #1d3557; /* Adjust color as needed */
            font-weight: bold;
            cursor: pointer;
            float: right;
            margin-top: -10px;
        }

        .post-card .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .post-header .post-info h3 {
            margin: 0;
            font-size: 16px;
        }

        .separator-line {
            border: none;
            border-top: 1px solid #e0e0e0; /* Light grey line */
            margin: 15px 0; /* Space above and below */
            width: 100%;
        }

        .post-header .post-info p {
            margin: 0;
            font-size: 14px;
            color: #777;
        }

        /* Three-dot menu styling */
        .menu-container {
            position: relative;
            margin-left: auto;
            cursor: pointer;
        }

        .three-dots {
            font-size: 24px;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            right: 0;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
            z-index: 1;
        }

        .dropdown-menu a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown-menu a:hover {
            background-color: #ddd;
        }

        .show {
            display: block;
        }

        .post-card video {
            width: 100%;
            border-radius: 12px;
            margin-bottom: 10px;
        }

        .post-card .actions {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
        }

        .post-card .actions button {
            background-color: transparent;
            border: none;
            cursor: pointer;
            color: #606770;
            font-size: 18px;
            display: flex;
            align-items: center;
            transition: color 0.2s ease, transform 0.2s ease;
        }

        .post-card .actions button:hover {
            color: #457b9d;
            transform: scale(1.05);
        }

        .post-card .actions i {
            margin-right: 5px;
        }

        /* Footer */
        .footer-nav {
            background-color: #1d3557;
            padding: 10px;
            color: white;
            text-align: center;
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        .footer-nav a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            transition: color 0.2s ease, transform 0.2s ease;
        }

        .footer-nav a:hover {
            color: #457b9d;
            transform: scale(1.05);
        }

        /* Media Queries */
        @media (max-width: 1000px) {
            .container {
                flex-direction: column;
                align-items: center;
            }

            .sidebar, .main-content, .sidebar-right {
                width: 100%;
                margin: 0;
            }

            .sidebar, .sidebar-right {
                margin-bottom: 20px;
            }
        }

        .nav-left ul li {
            list-style: none;
            display: inline-block;
        }

        .nav-left ul li img {
            width: 28px;
            margin: 0 15px;
        }

        .nav-user-login img {
            width: 40px;
            border-radius: 50%;
            cursor: pointer;
        }

        .nav-user-icon {
            margin-left: 0; /* Move the profile picture more to the left */
            width: 10%;
            height: 10%;
        }

        .search-box img {
            width: 18px;
        }

        .online {
            position: relative;
        }

        .online::after {
            content: '';
            width: 7px;
            height: 7px;
            border: 2px solid #fff;
            border-radius: 50%;
            background-color: #41db51;
            position: absolute;
            top: 0;
            right: 0;
        }

        .container {
            display: flex;
            justify-content: space-between;
            padding: 13px 5%;
        }

        .left-sidebar, .right-sidebar {
            flex-basis: 10%;
            position: sticky;
            top: 70px;
            align-self: flex-start;
        }

        .main-content {
            flex-basis: 60%;
            height: 40%;
            margin-right: 5%;
        }

        .imp-links a {
            text-decoration: none;
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            color: #626262;
            width: fit-content;
        }

        .imp-links a img {
            width: 25px;
            margin-right: 15px;
        }

        h3 {
            margin: 10px;
            color: #cbdffa;
        }

        .write-post-container {
            width: 100%;
            background: #fff;
            border-radius: 6px;
            padding: 20px;
            color: #626262;
        }

        .user-profile {
            display: flex;
            align-items: center;
        }

        .user-profile p {
            margin-bottom: -5px;
        }

        .user-profile small {
            font-size: 12px;
        }

        .post-input-container {
            padding-left: 55px;
            padding-top: 20px;
        }

        .post-input-container textarea {
            width: 100%;
            border: 0;
            outline: 0;
            border-bottom: 1px solid #ccc;
            background: transparent;
            resize: none;
        }

        .add-post-links {
            display: flex;
            margin-top: 10px;
        }

        .add-post-links button {
            text-decoration: none;
            display: flex;
            align-items: center;
            color: #626262;
            margin-right: 30px;
            font-size: 13px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
        }

        .add-post-links button img {
            width: 20px;
            margin-right: 10px;
        }

        /* Media Queries for Responsiveness */
        @media (max-width: 768px) {
            /* Remove left and right sidebar for mobile/tablet */
            .container {
                flex-direction: column; /* Stack elements vertically */
                padding: 0 5%;
            }

            .main-content {
                flex-basis: 100%; /* Full width for main content */
                margin-left: -5%; /* Adjust left margin */
                margin-right: 0;
            }

            .left-sidebar,
            .right-sidebar {
                display: none; /* Hide sidebars */
                flex-basis: 0%; /* No space allocated for sidebars */
                position: static; /* Remove sticky position */
            }

            nav {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                padding: 10px 5%;
            }

            .nav-left ul {
                display: flex;
                justify-content: space-around;
                width: 100%; /* Take full width of nav */
                padding: 10px 0;
            }

            .search-box {
                display: none; /* Hide the search input box */
            }

            .nav-right .search-icon {
                display: block; /* Show only the search icon on small screens */
                cursor: pointer;
            }

            .imp-links a {
                display: none; /* Hide sidebars */
                flex-basis: 0%; /* No space allocated for sidebars */
                position: static; /* Remove sticky position */
            }

            .write-post-container {
                padding: 15px;
            }

            .post-input-container textarea {
                padding-left: 0;
            }

            .post-input-container button {
                width: 100%;
            }

            .user-profile img {
                width: 35px;
            }

            .user-profile small {
                font-size: 10px;
            }

            .add-post-links button {
                font-size: 12px;
            }

            /* Hide some elements on mobile (optional) */
            .menu-container {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 1.2rem;
            }

            .nav-left ul li img {
                width: 24px;
                margin: 0 10px;
            }

            .post-input-container textarea {
                font-size: 14px;
            }

            .write-post-container {
                padding: 10px;
            }

            .add-post-links button {
                font-size: 12px;
                margin-right: 15px;
            }

            .actions button {
                font-size: 12px;
            }

            .comments textarea {
                font-size: 12px;
            }

            .comments button {
                font-size: 12px;
            }

            .post-header h3 {
                font-size: 14px;
            }

            .post-header p {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>

    <nav id="header">
        <div class="nav-left" style="display: flex; align-items: center;">
            <div class="nav-user-icon" style="margin-left: -10px; margin-right: 20px;">
                <a href="{{ url_for('public_feed') }}">
                    <img src="{{ url_for('static', filename='images/campusconnect.png') }}" style="width: 60px; height: 60px;">
                </a>
            </div>
            <div class="logo" style="margin-left: 20px;">UniRec</div>
        </div>
        <div class="nav-right" style="flex-grow: 1; justify-content: flex-end; position: relative;">
            <form action="{{ url_for('search') }}" method="POST" style="width: 50%; margin-right: 100px;">
                <div class="search-box" style="position: relative;">
                    <input type="text" name="search_query" placeholder="Search..." style="width: 100%; padding-left: 30px;">
                    <img src="{{ url_for('static', filename='images/searchicon.png') }}" alt="Search Icon" style="position: absolute; left: 20px; top: 50%; transform: translateY(-50%); width: 16px; height: 16px;">
                </div>
            </form>
            <div class="nav-user-icon" style="position: absolute; top: 0; right: 30px; margin: -5px;">
                <a href="{{ url_for('profile', username=user.username) }}">
                    <img src="{{ url_for('static', filename='profile_pics/' + user_profile_pic) }}" alt="Profile Picture" style="width: 50px; height: 50px;">
                </a>
            </div>
        </div>
    </nav>

<!-- Main Layout -->
<div class="container">
    <!-- Left Sidebar -->
    <div class="left-sidebar">
        <div class="imp-links">
            <a href="{{ url_for('friend_list') }}">
                <img src="{{ url_for('static', filename='images/friendsicon.png') }}" alt="Essays Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Friends
            </a>
            <a href="{{ url_for('chat') }}">
                <img src="{{ url_for('static', filename='images/chaticon.png') }}" alt="Mentors Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Chat
            </a>  
            <a href="{{ url_for('notifications') }}">
                <img src="{{ url_for('static', filename='images/notificationbell.png') }}" alt="Challenges Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Notifications
            </a>
            <a href="{{ url_for('servers') }}">
                <img src="{{ url_for('static', filename='images/servericon.png') }}" alt="Essays Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Server
            </a>
            <a href="{{ url_for('reels') }}">
                <img src="{{ url_for('static', filename='images/videoicon.png') }}" alt="Mentors Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Reels
            </a>  
            <a href="{{ url_for('webinar') }}">
                <img src="{{ url_for('static', filename='images/webinaricon.png') }}" alt="Challenges Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Webinar
            </a>
            <a href="{{ url_for('essays') }}">
                <img src="{{ url_for('static', filename='images/essays.png') }}" alt="Essays Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Essays
            </a>
            <a href="{{ url_for('mentors') }}">
                <img src="{{ url_for('static', filename='images/mentor.jpg') }}" alt="Mentors Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Mentors
            </a>  
            <a href="{{ url_for('challenges') }}">
                <img src="{{ url_for('static', filename='images/challenges.png') }}" alt="Challenges Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                Challenges
            </a>
            <a href="{{ url_for('eca_dashboard') }}">
                <img src="{{ url_for('static', filename='images/challenges.png') }}" alt="Challenges Icon" style="width:20px; height:20px; vertical-align:middle; margin-right:5px;">
                ECA
            </a>
        </div>
    </div>

    <!-- Main Content -->
<!-- Main Content -->
        <!-- Main Content: Video Feed -->
        <div class="main-content">

            <!-- Upload Section -->
            <div class="upload-section" style="background-color: #fff; border: 1px solid #ccc; border-radius: 10px; padding: 20px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); margin-bottom: 20px; display: flex; flex-direction: column; align-items: center; position: relative;">
                <div style="width: 100%; display: flex; justify-content: flex-start; align-items: center; margin-bottom: 15px;">
                    <a href="{{ url_for('view_profile', user_id=user.id) }}">
                        <img src="{{ url_for('static', filename='profile_pics/' + (user_profile_pic or 'default.jpg')) }}" alt="User Profile Picture" style="width: 50px; height: 50px; border-radius: 50%;">
                    </a>
                    <input type="text" placeholder="What's on your mind?" style="flex-grow: 1; margin-left: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 20px; font-size: 1rem;">
                </div>
                <div style="width: 100%; display: flex; justify-content: space-between; flex-wrap: wrap;">
                    <button onclick="location.href='{{ url_for('upload_video') }}'" style="background-color: #1434a8af; color: #fff; border: none; padding: 10px 15px; border-radius: 20px; cursor: pointer; display: flex; align-items: center; transition: background-color 0.3s ease, box-shadow 0.3s ease;">
                        <img src="{{ url_for('static', filename='images/videoicon.png') }}" alt="Video Icon" style="width: 20px; height: 20px; margin-right: 5px;">
                        Upload Video
                    </button>
                    <button onclick="location.href='{{ url_for('upload_reel') }}'" style="background-color: #1434a8af; color: #fff; border: none; padding: 10px 15px; border-radius: 20px; cursor: pointer; display: flex; align-items: center; transition: background-color 0.3s ease, box-shadow 0.3s ease;">
                        <img src="{{ url_for('static', filename='images/reels.png') }}" alt="Reel Icon" style="width: 20px; height: 20px; margin-right: 5px;">
                        Upload Reel
                    </button>
                    <button onclick="location.href='{{ url_for('upload_photo') }}'" style="background-color: #1434a8af; color: #fff; border: none; padding: 10px 15px; border-radius: 20px; cursor: pointer; display: flex; align-items: center; transition: background-color 0.3s ease, box-shadow 0.3s ease;">
                        <img src="{{ url_for('static', filename='images/photo.png') }}" alt="Photo Icon" style="width: 20px; height: 20px; margin-right: 5px;">
                        Upload Photo
                    </button>
                </div>
                <style>
                    button:hover {
                        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
                        background-color: #feffff;
                    }
                </style>
            </div>

            <!-- Create Post Section -->
            {% if videos %}
            {% for video in videos %}
                <!-- Inside the post-card -->
                <div class="post-card" style="background-color: #fff; border: 1px solid #ccc; border-radius: 10px; padding: 20px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); margin-bottom: 20px;">
                    <div class="post-header" style="display: flex; align-items: center; margin-bottom: 15px;">
                        <a href="{{ url_for('view_profile', user_id=video.uploader.id) }}" style="text-decoration: none; margin-right: 10px;">
                            <img src="{{ url_for('static', filename='profile_pics/' + (video.uploader.profile_pic or 'default.jpg')) }}" alt="Profile Picture" style="width: 50px; height: 50px; border-radius: 50%;">
                        </a>
                        <div>
                            <h3 style="margin: 0; font-size: 1.2rem;">{{ video.title }}</h3>
                            <p style="margin: 0; color: #606770;">Posted by <a href="{{ url_for('view_profile', user_id=video.uploader.id) }}" style="color: #1d3557; text-decoration: none;">{{ video.uploader.username }}</a></p>
                        </div>
                    </div>
                    {% if video.filename.endswith(('.mp4', '.avi', '.mov', '.wmv', '.flv')) %}
                    <div class="video-container" style="margin-bottom: 15px;">
                        <video controls width="100%" style="border-radius: 10px;">
                            <source src="{{ url_for('static', filename='videos/' + video.filename) }}" type="video/mp4">
                        </video>
                    </div>
                    {% elif video.filename.endswith(('.jpg', '.jpeg', '.png', '.gif')) %}
                    <img src="{{ url_for('static', filename='videos/' + video.filename) }}" alt="{{ video.title }}" width="100%" style="border-radius: 10px; margin-bottom: 15px;">
                    {% else %}
                    <p>File format not supported.</p>
                    {% endif %}
                    <p style="margin-bottom: 15px;">{{ video.description }}</p>

                    <div class="actions" style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                        <button onclick="reactPost({{ video.id }}, 'like')" style="background-color: transparent; border: none; cursor: pointer; color: #606770; font-size: 18px; display: flex; align-items: center; transition: color 0.2s ease, transform 0.2s ease;"><i class="fas fa-thumbs-up"></i> Like</button>
                        <button onclick="reactPost({{ video.id }}, 'love')" style="background-color: transparent; border: none; cursor: pointer; color: #606770; font-size: 18px; display: flex; align-items: center; transition: color 0.2s ease, transform 0.2s ease;"><i class="fas fa-heart"></i> Love</button>
                        <button onclick="reactPost({{ video.id }}, 'haha')" style="background-color: transparent; border: none; cursor: pointer; color: #606770; font-size: 18px; display: flex; align-items: center; transition: color 0.2s ease, transform 0.2s ease;"><i class="fas fa-laugh"></i> Haha</button>
                        <button onclick="toggleCommentSection({{ video.id }})" style="background-color: transparent; border: none; cursor: pointer; color: #606770; font-size: 18px; display: flex; align-items: center; transition: color 0.2s ease, transform 0.2s ease;"><i class="fas fa-comment"></i> Comment</button>
                        <button onclick="copyLink('{{ url_for('view_video_by_unique_id', unique_id=video.unique_id, _external=True) }}')" style="background-color: transparent; border: none; cursor: pointer; color: #606770; font-size: 18px; display: flex; align-items: center; transition: color 0.2s ease, transform 0.2s ease;">
                            <i class="fas fa-share"></i> Share
                        </button>
                    </div>
                    <div class="post-stats" style="margin-bottom: 15px;">
                        <p id="reaction-count-{{ video.id }}" style="margin: 0;">
                            {% if video.reaction_counts.like == 0 and video.reaction_counts.love == 0 and video.reaction_counts.haha == 0 %}
                                <span onclick="openReactionModal({{ video.id }})" style="cursor: pointer;">0 Reactions</span>
                            {% else %}
                                <span onclick="openReactionModal({{ video.id }}, 'like')" style="cursor: pointer;">{{ video.reaction_counts.like }} Likes</span> |
                                <span onclick="openReactionModal({{ video.id }}, 'love')" style="cursor: pointer;">{{ video.reaction_counts.love }} Loves</span> |
                                <span onclick="openReactionModal({{ video.id }}, 'haha')" style="cursor: pointer;">{{ video.reaction_counts.haha }} Hahas</span>
                            {% endif %}
                        </p>
                        <p id="comment-count-{{ video.id }}" style="margin: 0;">
                            <span onclick="toggleCommentSection({{ video.id }})" style="cursor: pointer;">{{ video.comments|length }} Comments</span>
                        </p>
                    </div>

                    <!-- Reaction Modal -->
                    <div id="reaction-modal-{{ video.id }}" class="modal" style="display: none;">
                        <div class="modal-content" style="background-color: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                            <button class="close-btn" onclick="closeReactionModal({{ video.id }})" style="background-color: transparent; border: none; font-size: 16px; color: #1d3557; font-weight: bold; cursor: pointer; float: right; margin-top: -10px;">Close</button>
                            <h3>Reactions</h3>
                            <ul id="reaction-users-list-{{ video.id }}"></ul>
                        </div>
                    </div>

                    <hr class="separator-line" style="margin: 15px 0;">
<!-- Comment Section -->
{% import 'macros.html' as macros %}

<!-- Define the Macro First -->
{% macro render_comment(comment, video_id) %}
    <li style="margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 20px; background-color: #f0f2f5;">
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center;">
                <a href="{{ url_for('view_profile', user_id=comment.user.id) }}" style="text-decoration: none; margin-right: 10px;">
                    <img src="{{ url_for('static', filename='profile_pics/' + (comment.user.profile_pic or 'default.jpg')) }}" alt="Profile Picture" style="width: 30px; height: 30px; border-radius: 50%;">
                </a>
                <div>
                    <strong><a href="{{ url_for('view_profile', user_id=comment.user.id) }}" style="color: #1d3557; text-decoration: none;">{{ comment.user.username }}</a></strong>: {{ comment.content }}
                </div>
            </div>
        </div>
        <button onclick="toggleReplyForm({{ comment.id }})" style="background-color: transparent; color: #457b9d; border: none; cursor: pointer;">Reply</button>


        <!-- Display Uploaded Image -->
        {% if comment.image %}
            <div style="margin-top: 10px;">
                <img src="{{ url_for('static', filename=comment.image) }}" alt="Uploaded Image" style="max-width: 100%; border-radius: 10px;">
            </div>
        {% endif %}

        {% if comment.gif_url %}
        <div style="margin-top: 10px;">
            <img src="{{ comment.gif_url }}" alt="GIF" style="max-width: 100%; border-radius: 10px;">
        </div>
    {% endif %}

        <!-- Reply Form -->
        <div id="reply-form-{{ comment.id }}" style="display: none; margin-top: 10px; padding-left: 40px;">
            <textarea id="reply-text-{{ comment.id }}" placeholder="Write a reply..." style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"></textarea>
            <input type="file" id="reply-image-{{ comment.id }}" accept="image/*" style="margin-top: 5px;">
            <button onclick="replyToComment({{ comment.id }}, {{ video_id }})" style="background-color: #457b9d; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; margin-top: 5px;">Submit Reply</button>
        </div>


        <!-- Nested Replies -->
        {% if comment.replies %}
            <ul style="list-style-type: none; margin-top: 10px; padding-left: 20px; border-left: 1px solid #ddd;">
                {% for reply in comment.replies %}
                    {{ render_comment(reply, video_id) }}
                {% endfor %}
            </ul>
        {% endif %}
    </li>
{% endmacro %}


<!-- Comment Section -->
<div id="comment-section-{{ video.id }}" class="comment-section" style="display: none; margin-top: 10px;">
    <!-- Add Comment Textarea -->
    <textarea id="comment-text-{{ video.id }}" placeholder="Add a comment" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; margin-bottom: 10px;"></textarea>
    
    
    <!-- Image Upload -->
    <input type="file" id="comment-image-{{ video.id }}" accept="image/*" style="margin-bottom: 10px;">
    
    <!-- Emoji Picker Button -->
    <button type="button" onclick="toggleEmojiPicker({{ video.id }})" style="background-color: transparent; border: none; cursor: pointer;">
        üòÄ
    </button>
    <!-- GIF Picker Button -->
    <button type="button" onclick="toggleGifPicker({{ video.id }})" style="background-color: transparent; border: none; cursor: pointer;">üé•</button>
    <div id="gif-picker-{{ video.id }}" class="gif-picker" style="display: none;">
        <input type="text" id="gif-search-{{ video.id }}" placeholder="Search GIFs..." oninput="searchGifs({{ video.id }})" style="width: 100%; padding: 5px; margin-bottom: 10px;">
        <div id="gif-results-{{ video.id }}" style="max-height: 200px; overflow-y: auto;"></div>
    </div>

    <!-- Selected GIF Preview -->
    <div id="gif-preview-{{ video.id }}" style="margin-top: 10px;"></div>
    <input type="hidden" id="gif-url-{{ video.id }}" value="">
    <!-- Emoji Picker Container -->
    <div id="emoji-picker-{{ video.id }}" class="emoji-picker" style="display: none;"></div>
    <button onclick="commentPost({{ video.id }})" style="background-color: #457b9d; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer;">Post Comment</button>

    <ul style="list-style-type: none; padding: 0; margin-top: 15px;">
        {% for comment in video.comments if not comment.parent_id %}
            {{ macros.render_comment(comment, video.id) }}
        {% endfor %}
    </ul>
</div>

{% import 'macros.html' as macros %}

<div id="comment-section-{{ video.id }}" class="comment-section" style="display: none; margin-top: 10px;">
    <textarea id="comment-text-{{ video.id }}" placeholder="Add a comment" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; margin-bottom: 10px;"></textarea>
    <button onclick="commentPost({{ video.id }})" style="background-color: #457b9d; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer;">Post Comment</button>

    <ul style="list-style-type: none; padding: 0; margin-top: 15px;">
        {% for comment in video.comments if not comment.parent_id %}
            {{ macros.render_comment(comment, video.id) }}
        {% endfor %}
    </ul>
</div>


                </div>
            {% endfor %}
            {% else %}
                <p>No content available.</p>
            {% endif %}
        </div>

    <!-- Right Sidebar -->
    <div class="right-sidebar">
        <h3>Suggestions</h3>
        <div class="imp-links">
            <a href="{{ url_for('public_feed') }}"><img src="{{ url_for('static', filename='images/homeicon.png') }}">Home</a>
            <a href="{{ url_for('profile') }}"><img src="{{ url_for('static', filename='images/profileicon.png') }}"> Profile</a>
            <a href="{{ url_for('helpers_section') }}"><img src="{{ url_for('static', filename='images/helpers.png') }}"> Helpers</a>
            <a href="{{ url_for('scholarshipsearch') }}"><img src="{{ url_for('static', filename='images/scholarshipicon.png') }}"> Scholarship Search</a>
            <a href="{{ url_for('ai_search') }}"><img src="{{ url_for('static', filename='images/ai.png') }}"> AI Search</a>
            <a href="{{ url_for('courses') }}"><img src="{{ url_for('static', filename='images/coursesicon.png') }}"> Courses</a>
        </div>
    </div>
</div>



    <!-- JavaScript for Reactions, Comments, and Sharing -->
    <script>
        function toggleMenu(videoId) {
            var menu = document.getElementById('menu-' + videoId);
            menu.classList.toggle('show');
        }
        function sendFriendRequest(userId) {
                fetch(`/send_friend_request/${userId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }).then(response => {
                    if (response.status === 200) {
                        alert('Friend request sent!');
                    } else {
                        alert('Error sending friend request.');
                    }
                });
            }
    
        function deleteVideo(videoId) {
            if (confirm('Are you sure you want to delete this video?')) {
                fetch(`/delete_video/${videoId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }).then(response => {
                    if (response.status === 200) {
                        alert('Video deleted!');
                        window.location.reload(); // Reload the page after deletion
                    } else {
                        alert('Error deleting video.');
                    }
                });
            }
        }
    

        function toggleCommentSection(videoId) {
    // Find the comment section for the specific video
    const commentSection = document.getElementById(`comment-section-${videoId}`);

    // Toggle the visibility of the comment section
    if (commentSection.style.display === 'none' || commentSection.style.display === '') {
        commentSection.style.display = 'block';
    } else {
        commentSection.style.display = 'none';
    }
}


        function reactPost(videoId, reactionType) {
            fetch(`/react_video/${videoId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ reaction_type: reactionType }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // Update reaction counts dynamically
                    const reactionCountElement = document.getElementById(`reaction-count-${videoId}`);
                    reactionCountElement.innerHTML = `
                        <span onclick="openReactionModal(${videoId}, 'like')">${data.reactions.like} Likes</span> |
                        <span onclick="openReactionModal(${videoId}, 'love')">${data.reactions.love} Loves</span> |
                        <span onclick="openReactionModal(${videoId}, 'haha')">${data.reactions.haha} Hahas</span>
                    `;
    
                    // Change button color to indicate the reaction was applied
                    const buttons = document.querySelectorAll(`#post-${videoId} .actions button`);
                    buttons.forEach(button => {
                        if (button.innerText.toLowerCase().includes(reactionType)) {
                            button.style.color = 'darkblue';
                        } else {
                            button.style.color = ''; // Reset other buttons
                        }
                    });
                } else {
                    alert('Error adding reaction.');
                }
            })
            .catch(error => console.error('Error:', error));
        }
    
        function openReactionModal(videoId, reactionType) {
    // Fetch users who reacted
    fetch(`/get_reaction_users/${videoId}/${reactionType}`)
        .then(response => response.json())
        .then(data => {
            // Populate the modal with usernames
            const usersList = document.getElementById(`reaction-users-list-${videoId}`);
            usersList.innerHTML = '';
            data.users.forEach(user => {
                const userItem = document.createElement('li');
                userItem.textContent = user.username;
                usersList.appendChild(userItem);
            });

            // Show the modal for the correct video
            document.getElementById(`reaction-modal-${videoId}`).style.display = 'block';
        });
}

// Load emojis from the emojis.json file
function loadEmojis(videoId) {
    fetch('/static/emojis.json')
        .then((response) => response.json())
        .then((emojis) => {
            const emojiPicker = document.getElementById(`emoji-picker-${videoId}`);
            emojiPicker.innerHTML = ''; // Clear previous emojis
            
            emojis.forEach((emojiObj) => {
                const emoji = document.createElement('span');
                emoji.classList.add('emoji');
                emoji.textContent = emojiObj.emoji;
                emoji.title = emojiObj.description; // Add a tooltip for description
                
                // Add click event to insert emoji into textarea
                emoji.addEventListener('click', () => {
                    const commentTextarea = document.getElementById(`comment-text-${videoId}`);
                    commentTextarea.value += emojiObj.emoji; // Append emoji to the comment
                    emojiPicker.style.display = 'none'; // Hide emoji picker after selection
                });
                
                emojiPicker.appendChild(emoji);
            });
        })
        .catch((error) => console.error('Error loading emojis:', error));
}

// Toggle emoji picker visibility
function toggleEmojiPicker(videoId) {
    const emojiPicker = document.getElementById(`emoji-picker-${videoId}`);
    if (emojiPicker.style.display === 'none') {
        emojiPicker.style.display = 'block';
        loadEmojis(videoId); // Load emojis when the picker is shown
    } else {
        emojiPicker.style.display = 'none';
    }
}

function likeComment(commentId) {
    fetch(`/like_comment/${commentId}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
    })
        .then((response) => response.json())
        .then((data) => {
            if (data.message) {
                // Update the like count
                const likeCountElement = document.getElementById(`like-count-${commentId}`);
                likeCountElement.textContent = data.like_count;

                // Update the heart icon color
                const heartIcon = document.getElementById(`heart-icon-${commentId}`);
                if (data.message === 'Comment liked') {
                    heartIcon.style.color = 'red'; // Change to red when liked
                } else {
                    heartIcon.style.color = 'white'; // Change back to white when unliked
                }
            } else {
                alert(data.error || 'An error occurred');
            }
        })
        .catch((error) => console.error('Error:', error));
}

function supportComment(commentId) {
    fetch(`/support_comment/${commentId}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
    })
        .then((response) => response.json())
        .then((data) => {
            if (data.message) {
                // Update the support count
                const supportCountElement = document.getElementById(`support-count-${commentId}`);
                supportCountElement.textContent = data.support_count;

                // Update the support button appearance
                const supportButton = document.getElementById(`support-btn-${commentId}`);
                if (data.message === 'Comment supported') {
                    supportButton.style.color = 'green'; // Change color to indicate support
                } else {
                    supportButton.style.color = '#457b9d'; // Reset color to default
                }
            } else {
                alert(data.error || 'An error occurred');
            }
        })
        .catch((error) => console.error('Error:', error));
}

        function closeReactionModal(videoId) {
            document.getElementById(`reaction-modal-${videoId}`).style.display = 'none';
        }

        function commentPost(videoId) {
    const commentTextElement = document.getElementById(`comment-text-${videoId}`);
    const commentText = commentTextElement.value.trim();
    const commentImage = document.getElementById(`comment-image-${videoId}`).files[0];
    const gifUrl = document.getElementById(`gif-url-${videoId}`).value;

    // Ensure at least text, an image, or a GIF is provided
    if (!commentText && !commentImage && !gifUrl) {
        alert("Comment must contain text, a GIF, or an image!");
        return;
    }

    const formData = new FormData();
    formData.append('content', commentText); // Add text content
    formData.append('video_id', videoId); // Add video ID
    if (commentImage) {
        formData.append('image', commentImage); // Add image if provided
    }
    if (gifUrl) {
        formData.append('gif_url', gifUrl); // Add GIF URL if provided
    }

    fetch('/add_comment', {
        method: 'POST',
        body: formData,
    })
        .then(response => response.json())
        .then(data => {
            if (data.message) {
                // Clear the form fields
                commentTextElement.value = '';
                document.getElementById(`comment-image-${videoId}`).value = '';
                document.getElementById(`gif-preview-${videoId}`).innerHTML = '';
                document.getElementById(`gif-url-${videoId}`).value = '';

                // Dynamically add the new comment to the DOM
                const commentList = document.querySelector(`#comment-section-${videoId} ul`);
                const newComment = document.createElement('li');
                newComment.id = `comment-${data.comment_id}`;
                newComment.style.marginBottom = '10px';
                newComment.style.padding = '10px';
                newComment.style.border = '1px solid #ddd';
                newComment.style.borderRadius = '20px';
                newComment.style.backgroundColor = '#f0f2f5';

                // Construct the comment content
                newComment.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center;">
                            <a href="/view_profile/${data.user.id}" style="text-decoration: none; margin-right: 10px;">
                                <img src="/static/profile_pics/${data.user.profile_pic}" alt="Profile Picture" style="width: 30px; height: 30px; border-radius: 50%;">
                            </a>
                            <div>
                                <strong><a href="/view_profile/${data.user.id}" style="color: #1d3557; text-decoration: none;">${data.user.username}</a></strong>: ${data.content || ''}
                            </div>
                        </div>
                    </div>
                    ${data.image ? `<div style="margin-top: 10px;"><img src="/static/${data.image}" style="max-width: 100%; border-radius: 10px;"></div>` : ''}
                    ${data.gif_url ? `<div style="margin-top: 10px;"><img src="${data.gif_url}" style="max-width: 100%; border-radius: 10px;"></div>` : ''}
                    <div style="margin-top: 10px;">
                        <!-- Like Button -->
                        <button onclick="likeComment(${data.comment_id})" id="like-btn-${data.comment_id}" style="background-color: transparent; border: none; cursor: pointer;">
                            ‚ù§Ô∏è
                        </button>
                        <span id="like-count-${data.comment_id}">0</span>
                        <!-- Support Button -->
                        <button onclick="supportComment(${data.comment_id})" id="support-btn-${data.comment_id}" style="background-color: transparent; border: none; cursor: pointer; color: #457b9d;">
                            ü§ù
                        </button>
                        <span id="support-count-${data.comment_id}">0</span>
                    </div>
                    <div style="margin-top: 10px;">
                        <!-- Reply Button -->
                        <button onclick="toggleReplyForm(${data.comment_id})" style="background-color: transparent; color: #457b9d; border: none; cursor: pointer;">Reply</button>
                        <div id="reply-form-${data.comment_id}" style="display: none; margin-top: 10px; padding-left: 40px;">
                            <textarea id="reply-text-${data.comment_id}" placeholder="Write a reply..." style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"></textarea>
                            <input type="file" id="reply-image-${data.comment_id}" accept="image/*" style="margin-top: 5px;">
                            <button onclick="replyToComment(${data.comment_id}, ${videoId})" style="background-color: #457b9d; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; margin-top: 5px;">Submit Reply</button>
                        </div>
                    </div>
                `;

                // Append the new comment to the list
                commentList.appendChild(newComment);
            } else {
                alert(data.error || 'An error occurred while adding the comment.');
            }
        })
        .catch(error => console.error('Error:', error));
}

function addCommentToUI(videoId, comment) {
    const commentList = document.querySelector(`#comment-section-${videoId} ul`);

    const commentHTML = `
        <li style="margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 20px; background-color: #f0f2f5;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center;">
                    <a href="/view_profile/${comment.user.id}" style="text-decoration: none; margin-right: 10px;">
                        <img src="/static/profile_pics/${comment.user.profile_pic}" alt="Profile Picture" style="width: 30px; height: 30px; border-radius: 50%;">
                    </a>
                    <div>
                        <strong><a href="/view_profile/${comment.user.id}" style="color: #1d3557; text-decoration: none;">${comment.user.username}</a></strong>: ${comment.content || ''}
                    </div>
                </div>
            </div>
            ${comment.image ? `<div style="margin-top: 10px;"><img src="/static/${comment.image}" alt="Uploaded Image" style="max-width: 100%; border-radius: 10px;"></div>` : ''}
            ${comment.gif_url ? `<div style="margin-top: 10px;"><img src="${comment.gif_url}" alt="GIF" style="max-width: 100%; border-radius: 10px;"></div>` : ''}
        </li>
    `;

    commentList.insertAdjacentHTML('beforeend', commentHTML); // Add the new comment to the list
}

const GIPHY_API_KEY = '8tYIRbNTm0wH1UdRKy2AA11H2lbH4HTS'; // Replace with your Giphy API Key

// Toggle the GIF picker visibility
function toggleGifPicker(videoId) {
    const gifPicker = document.getElementById(`gif-picker-${videoId}`);
    gifPicker.style.display = gifPicker.style.display === 'none' ? 'block' : 'none';
}
function searchGifs(videoId) {
    const query = document.getElementById(`gif-search-${videoId}`).value.trim();
    if (!query) return;

    const gifResults = document.getElementById(`gif-results-${videoId}`);
    gifResults.innerHTML = 'Loading...'; // Show loading text

    fetch(`https://api.giphy.com/v1/gifs/search?api_key=${GIPHY_API_KEY}&q=${encodeURIComponent(query)}&limit=10`)
        .then((response) => response.json())
        .then((data) => {
            gifResults.innerHTML = ''; // Clear previous results

            data.data.forEach((gif) => {
                const gifThumbnail = document.createElement('img');
                gifThumbnail.src = gif.images.fixed_width.url;
                gifThumbnail.className = 'gif-thumbnail';
                gifThumbnail.alt = gif.title;

                // Add click event to select GIF
                gifThumbnail.addEventListener('click', () => {
                    // Render the selected GIF visually
                    const gifPreviewContainer = document.getElementById(`gif-preview-${videoId}`);
                    gifPreviewContainer.innerHTML = ''; // Clear any previous GIF
                    const selectedGif = document.createElement('img');
                    selectedGif.src = gif.images.fixed_width.url;
                    selectedGif.style.maxWidth = '100%';
                    selectedGif.style.marginTop = '10px';
                    gifPreviewContainer.appendChild(selectedGif);

                    // Store the selected GIF URL in a hidden input field
                    const gifUrlInput = document.getElementById(`gif-url-${videoId}`);
                    gifUrlInput.value = gif.images.fixed_width.url;

                    // Hide the GIF picker after selection
                    const gifPicker = document.getElementById(`gif-picker-${videoId}`);
                    gifPicker.style.display = 'none';
                });

                gifResults.appendChild(gifThumbnail);
            });
        })
        .catch((error) => console.error('Error fetching GIFs:', error));
}

function toggleReplyForm(commentId) {
    const replyForm = document.getElementById(`reply-form-${commentId}`);
    replyForm.style.display = replyForm.style.display === 'none' ? 'block' : 'none';
}
function replyToComment(commentId, videoId) {
    const replyTextElement = document.getElementById(`reply-text-${commentId}`);
    const replyContent = replyTextElement.value.trim();
    const replyImageElement = document.getElementById(`reply-image-${commentId}`);
    const replyImage = replyImageElement.files[0];

    // Ensure at least text or an image is provided
    if (!replyContent && !replyImage) {
        alert("Reply must contain text or an image!");
        return;
    }

    const formData = new FormData();
    formData.append('content', replyContent); // Add text content
    formData.append('video_id', videoId); // Add video ID
    formData.append('parent_id', commentId); // Associate reply with parent comment
    if (replyImage) {
        formData.append('image', replyImage); // Add image if provided
    }

    fetch('/add_comment', {
        method: 'POST',
        body: formData,
    })
        .then(response => response.json())
        .then(data => {
            if (data.message) {
                // Clear the reply form fields
                replyTextElement.value = '';
                replyImageElement.value = '';

                // Dynamically add the new reply to the DOM
                let replyList = document.getElementById(`reply-list-${commentId}`);
                if (!replyList) {
                    // If the reply list doesn't exist yet, create it
                    replyList = document.createElement('ul');
                    replyList.id = `reply-list-${commentId}`;
                    replyList.style.listStyleType = 'none';
                    replyList.style.marginTop = '10px';
                    replyList.style.paddingLeft = '20px';
                    replyList.style.borderLeft = '1px solid #ddd';

                    // Append the reply list to the comment
                    document.getElementById(`comment-${commentId}`).appendChild(replyList);
                }

                // Create the new reply element
                const newReply = document.createElement('li');
                newReply.id = `comment-${data.comment_id}`;
                newReply.style.marginBottom = '10px';
                newReply.style.padding = '10px';
                newReply.style.border = '1px solid #ddd';
                newReply.style.borderRadius = '20px';
                newReply.style.backgroundColor = '#f8f9fa';

                // Construct the reply content
                newReply.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center;">
                            <a href="/view_profile/${data.user.id}" style="text-decoration: none; margin-right: 10px;">
                                <img src="/static/profile_pics/${data.user.profile_pic}" alt="Profile Picture" style="width: 25px; height: 25px; border-radius: 50%;">
                            </a>
                            <div>
                                <strong><a href="/view_profile/${data.user.id}" style="color: #1d3557; text-decoration: none;">${data.user.username}</a></strong>: ${data.content || ''}
                            </div>
                        </div>
                        <button onclick="toggleReplyForm(${data.comment_id})" style="background-color: transparent; color: #457b9d; border: none; cursor: pointer;">Reply</button>
                    </div>
                    ${data.image ? `<div style="margin-top: 10px;"><img src="/static/${data.image}" style="max-width: 100%; border-radius: 10px;"></div>` : ''}
                    ${data.gif_url ? `<div style="margin-top: 10px;"><img src="${data.gif_url}" style="max-width: 100%; border-radius: 10px;"></div>` : ''}
                    <div style="margin-top: 10px;">
                        <!-- Like Button -->
                        <button onclick="likeComment(${data.comment_id})" id="like-btn-${data.comment_id}" style="background-color: transparent; border: none; cursor: pointer;">
                            ‚ù§Ô∏è
                        </button>
                        <span id="like-count-${data.comment_id}">0</span>
                        <!-- Support Button -->
                        <button onclick="supportComment(${data.comment_id})" id="support-btn-${data.comment_id}" style="background-color: transparent; border: none; cursor: pointer; color: #457b9d;">
                            ü§ù
                        </button>
                        <span id="support-count-${data.comment_id}">0</span>
                    </div>
                `;

                // Append the new reply to the reply list
                replyList.appendChild(newReply);

                // Optionally close the reply form
                toggleReplyForm(commentId);
            } else {
                alert(data.error || 'An error occurred while adding the reply.');
            }
        })
        .catch(error => console.error('Error:', error));
}

function renderComments(comments) {
    const commentSection = document.getElementById('comment-section');
    commentSection.innerHTML = ''; // Clear existing comments

    comments.forEach(comment => {
        // Create top-level comment element
        const commentElement = document.createElement('div');
        commentElement.className = 'comment';
        commentElement.innerHTML = `
            <p><strong>${comment.user_id}</strong>: ${comment.content}</p>
            <button onclick="showReplyForm(${comment.id})">Reply</button>
            <div id="reply-form-${comment.id}" style="display: none;">
                <textarea id="reply-text-${comment.id}"></textarea>
                <button onclick="submitReply(${comment.id})">Submit</button>
            </div>
        `;

        // Create replies container
        const repliesContainer = document.createElement('div');
        repliesContainer.className = 'replies';

        // Render replies
        comment.replies.forEach(reply => {
            const replyElement = document.createElement('div');
            replyElement.className = 'reply';
            replyElement.innerHTML = `<p><strong>${reply.user_id}</strong>: ${reply.content}</p>`;
            repliesContainer.appendChild(replyElement);
        });

        // Append replies to the comment
        commentElement.appendChild(repliesContainer);

        // Add the comment to the comment section
        commentSection.appendChild(commentElement);
    });
}

    
        function copyLink(link) {
            navigator.clipboard.writeText(link).then(() => {
                alert('Link copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy link: ', err);
            });
        }
    
        function sharePost(videoId) {
            fetch(`/share_video/${videoId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    alert('Post shared!');
                    location.reload();  // Reload page to show the shared post
                } else {
                    alert('Error sharing post.');
                }
            });
        }

        let lastScrollPosition = 0;
    const header = document.getElementById("header");

    window.addEventListener("scroll", () => {
        const currentScrollPosition = window.pageYOffset;

        if (currentScrollPosition > lastScrollPosition) {
            // Scrolling down
            header.classList.add("hidden");
        } else {
            // Scrolling up
            header.classList.remove("hidden");
        }

        lastScrollPosition = currentScrollPosition;
    });
        </script>
    
    </body>
    </html>